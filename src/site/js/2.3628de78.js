(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"1SLc":function(e,a,s){"use strict";var t=s("i7Hu"),l=s.n(t);l.a},"1U9L":function(e,a,s){"use strict";s.r(a);var t=function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",[s("div",{staticClass:"panel__group"},[s("div",{staticClass:"panel__title"},[e._v("\n      基本信息\n    ")]),s("ul",{staticClass:"panel__items"},[s("li",{staticClass:"panel__item"},[s("label",{staticClass:"panel__label label--account"},[e._v("登录账号：")]),s("div",{staticClass:"panel__content"},[e._v("\n          "+e._s(e.user.loginName)+"\n        ")])]),s("li",{staticClass:"panel__item"},[s("label",{staticClass:"panel__label label--password"},[e._v("密码：")]),s("div",{staticClass:"panel__content"},[s("a",{staticClass:"link",on:{click:e.openPasswordResetPopup}},[e._v("修改密码")])])]),s("li",{staticClass:"panel__item"},[s("label",{staticClass:"panel__label label--name"},[e._v("姓名：")]),s("div",{staticClass:"panel__content"},[e._v("\n          "+e._s(e.user.name)+"\n        ")])]),s("li",{staticClass:"panel__item"},[s("label",{staticClass:"panel__label label--role"},[e._v("角色：")]),s("div",{staticClass:"panel__content"},[e._v("\n          "+e._s(e.user.roleBeans.map(function(e){return e.name}).join(" || "))+"\n        ")])])])]),s("div",{staticClass:"panel__group"},[s("div",{staticClass:"panel__title"},[e._v("\n      联系方式\n    ")]),s("ul",{staticClass:"panel__items"},[s("li",{staticClass:"panel__item"},[s("label",{staticClass:"panel__label label--email"},[e._v("邮箱")]),s("div",{staticClass:"panel__content"},[e.editing.value&&"email"===e.editing.prop?s("el-input",{ref:"email",staticStyle:{display:"inline-block",width:"200px"},attrs:{value:e.user.email},on:{blur:e.updateEmail}}):[s("span",[e._v(e._s(e.user.email))]),s("i",{staticClass:"edit__btn el-icon-edit-outline",on:{click:function(a){e.edit("email")}}})]],2)]),s("li",{staticClass:"panel__item"},[s("label",{staticClass:"panel__label label--telephone"},[e._v("手机号")]),s("div",{staticClass:"panel__content"},[e.editing.value&&"mobile"===e.editing.prop?s("el-input",{ref:"mobile",staticStyle:{display:"inline-block",width:"200px"},attrs:{value:e.user.mobile},on:{blur:e.updateMobile}}):[s("span",[e._v(e._s(e.user.mobile))]),s("i",{staticClass:"edit__btn el-icon-edit-outline",on:{click:function(a){e.edit("mobile")}}})]],2)])])]),s("el-dialog",{attrs:{title:"修改密码",width:"450px",visible:e.changePasswordPopup.visible},on:{close:function(a){e.changePasswordPopup.visible=!1}}},[s("el-form",[s("el-form-item",{attrs:{label:"新密码",required:"","label-width":"120px",error:e.changePasswordPopup.oldPassword.error}},[s("el-input",{attrs:{type:"password",placeholder:"请输入1-20个字符"},model:{value:e.changePasswordPopup.oldPassword.value,callback:function(a){e.$set(e.changePasswordPopup.oldPassword,"value",a)},expression:"changePasswordPopup.oldPassword.value"}})],1),s("el-form-item",{attrs:{label:"再次输入新密码",required:"","label-width":"120px",error:e.changePasswordPopup.newPassword.error}},[s("el-input",{attrs:{type:"password",placeholder:"再次输入新密码"},model:{value:e.changePasswordPopup.newPassword.value,callback:function(a){e.$set(e.changePasswordPopup.newPassword,"value",a)},expression:"changePasswordPopup.newPassword.value"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(a){e.changePasswordPopup.visible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.changePassword}},[e._v("确认")])],1)],1)],1)},l=[],i=(s("f3/d"),s("yT7P")),n=s("Kw5r"),o=s("Nlzp"),r={data:function(){return{changePasswordPopup:{visible:!1,oldPassword:{value:"",error:""},newPassword:{value:"",error:""}},editing:{value:!1,prop:""}}},computed:{user:function(){return this.$store.getters.user}},methods:{openPasswordResetPopup:function(){this.changePasswordPopup={visible:!0,oldPassword:{value:"",touched:!1,valid:!1,error:""},newPassword:{value:"",touched:!1,valid:!1,error:""}}},changePassword:function(){var e=this,a=this.changePasswordPopup,s=a.oldPassword,t=a.newPassword,l=s.value.trim(),n=t.value.trim();l?l.length>20?(s.valid=!1,s.error="新密码1-20个字符"):(s.valid=!0,s.error=""):(s.valid=!1,s.error="请输入新密码"),console.log("check changePasswordPopup.oldPassword",Object(i["a"])({},s)),n?n!==s.value?(t.valid=!1,t.error="新密码两次输入不一致"):(t.valid=!0,t.error=""):(t.valid=!1,t.error="请再次输入新密码"),console.log("check changePasswordPopup.newPassword",Object(i["a"])({},t)),s.valid&&t.valid&&o["a"].IUserService.updateDefaultPassword({loginName:this.user.loginName,password:n}).then(function(){e.changePasswordPopup.visible=!1}).catch(function(a){e.$message({type:"error",message:a.message||"密码修改失败"})})},updateEmail:function(e){var a=this,s=e.target.value.trim();o["a"].IOrganizationManager.updateOrganizationSubUser(Object(i["a"])({},this.user,{email:s,roles:this.user.roleBeans.map(function(e){return e.name}).join(",")})).then(function(){a.$store.commit("UPDATE_USER",{email:s}),a.editing.value=!1}).catch(function(s){e.target.focus(),a.$message({type:"error",message:s.message||"邮箱修改失败"})})},updateMobile:function(e){var a=this,s=e.target.value.trim();o["a"].IOrganizationManager.updateOrganizationSubUser(Object(i["a"])({},this.user,{mobile:s,roles:this.user.roleBeans.map(function(e){return e.name}).join(",")})).then(function(){a.$store.commit("UPDATE_USER",{mobile:s}),a.editing.value=!1}).catch(function(s){e.target.focus(),a.$message({type:"error",message:s.message||"手机号修改失败"})})},edit:function(e){var a=this;this.editing.value||(this.editing={value:!0,prop:e},n["default"].nextTick(function(){a.$refs[e].focus()}))}}},c=r,u=(s("1SLc"),s("KHd+")),p=Object(u["a"])(c,t,l,!1,null,"5472b3ae",null);a["default"]=p.exports},i7Hu:function(e,a,s){}}]);