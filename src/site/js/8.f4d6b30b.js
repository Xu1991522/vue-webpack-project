(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"UMj/":function(e,a,t){"use strict";var l=t("r/XA"),o=t.n(l);o.a},"j+wa":function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",[t("div",{staticClass:"pannel__header"},[e._v("\n    企业信息\n  ")]),t("el-form",{ref:"ruleForm",staticClass:"iot__form form-pos",attrs:{"label-width":"120px",model:e.ruleForm,rules:e.rules,"label-position":"left"}},[t("div",{staticClass:"info-item"},[t("div",{staticClass:"inner-filt"},[e._v("基本信息")])]),t("el-form-item",{attrs:{label:"企业简称:",prop:"shortName"}},[t("span",[e._v(e._s(e.ruleForm.shortName))])]),t("el-form-item",{attrs:{label:"企业全称:",prop:"fullName"}},[e.internal?t("div",{staticClass:"panel__content"},[e.editing.value&&"fullName"===e.editing.prop?t("el-input",{ref:"email",staticStyle:{display:"inline-block",width:"200px"},attrs:{value:e.ruleForm.fullName},on:{blur:e.updateFullName}}):[t("span",[e._v(e._s(e.ruleForm.fullName))]),t("i",{staticClass:"edit__btn el-icon-edit-outline",on:{click:function(a){e.edit("fullName")}}})]],2):t("span",[e._v(e._s(e.ruleForm.fullName))])]),t("el-form-item",{attrs:{label:"企业ID:",prop:"id"}},[t("span",[e._v(e._s(e.ruleForm.id))])]),t("el-form-item",{attrs:{label:"营业执照扫描件:"}},[t("el-upload",{staticClass:"upload__container upload--license",attrs:{name:"file","show-file-list":!1,action:"/portal-srv/upload/idcard","before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("up"),"on-progress":e.handleUploadProgress("up")}},[e.images.up?t("img",{staticClass:"avatar",attrs:{src:e.images.up}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("el-form-item",{attrs:{label:"APP ID:",prop:"appId"}},[t("span",[e._v(e._s(e.ruleForm.appId))])]),t("el-form-item",{attrs:{label:"API密码:",prop:"apiPass"}},[t("span",[e._v(e._s(e.ruleForm.apiPass))])]),t("div",{staticClass:"info-item"},[t("div",{staticClass:"inner-filt"},[e._v("企业联系人")])]),t("el-form-item",{attrs:{label:"姓名:",prop:"contact"}},[e.internal?t("div",{staticClass:"panel__content"},[e.editing.value&&"contact"===e.editing.prop?t("el-input",{ref:"contact",staticStyle:{display:"inline-block",width:"200px"},attrs:{value:e.ruleForm.contact},on:{blur:e.updateContact}}):[t("span",[e._v(e._s(e.ruleForm.contact))]),t("i",{staticClass:"edit__btn el-icon-edit-outline",on:{click:function(a){e.edit("contact")}}})]],2):t("span",[e._v(e._s(e.ruleForm.contact))])]),t("el-form-item",{attrs:{label:"手机号:",prop:"mobilePhone"}},[e.internal?t("div",{staticClass:"panel__content"},[e.editing.value&&"mobilePhone"===e.editing.prop?t("el-input",{ref:"mobilePhone",staticStyle:{display:"inline-block",width:"200px"},attrs:{value:e.ruleForm.mobilePhone},on:{blur:e.updateMobilePhone}}):[t("span",[e._v(e._s(e.ruleForm.mobilePhone))]),t("i",{staticClass:"edit__btn el-icon-edit-outline",on:{click:function(a){e.edit("mobilePhone")}}})]],2):t("span",[e._v(e._s(e.ruleForm.mobilePhone))])]),t("el-form-item",{attrs:{label:"身份证号码:",prop:"idCard"}},[t("span",[e._v(e._s(e.ruleForm.idCard))])]),t("el-form-item",{attrs:{label:"电话号码:",prop:"phone"}},[t("span",[e._v(e._s(e.ruleForm.phone))])]),t("el-form-item",{attrs:{label:"电子邮箱:",prop:"email"}},[t("span",[e._v(e._s(e.ruleForm.email))])]),t("el-form-item",{staticStyle:{"min-width":"800px"},attrs:{label:"证件图片:"}},[t("el-upload",{staticClass:"upload__container upload--up",attrs:{name:"file","show-file-list":!1,action:"/portal-srv/upload/idcard","before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("up"),"on-progress":e.handleUploadProgress("up")}},[e.images.up?t("img",{staticClass:"avatar",attrs:{src:e.images.up}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("el-upload",{staticClass:"upload__container upload--down",attrs:{action:"/portal-srv/upload/idcard",name:"file","show-file-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("down"),"on-progress":e.handleUploadProgress("down")}},[e.images.down?t("img",{staticClass:"avatar",attrs:{src:e.images.down}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("el-upload",{staticClass:"upload__container upload--hand",attrs:{action:"/portal-srv/upload/idcard",name:"file","show-file-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("hand"),"on-progress":e.handleUploadProgress("hand")}},[e.images.hand?t("img",{staticClass:"avatar",attrs:{src:e.images.hand}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)],1)],1)},o=[],s=t("yT7P"),r=(t("xfY5"),t("Kw5r")),i=t("Nlzp"),n=function(e,a,t){isNaN(a)||11!==a.length?t(new Error("请输入正确的手机号")):t()},u={name:"",data:function(){return{images:{up:"",down:"",hand:"",license:""},urls:{up:"",down:"",hand:"",license:""},progress:{up:0,down:0,hand:0,license:0},ruleForm:{},rules:{fullName:[{required:!0,message:"请输入企业全称，与营业执照一致",trigger:"blur"}],contact:[{required:!0,min:1,max:20,message:"请输入1-20个字符",trigger:"blur"}],mobilePhone:[{required:!0,validator:n,trigger:"blur"}]},editing:{value:!1,prop:""}}},computed:{user:function(){return this.$store.getters.user},internal:function(){return"ADMIN"===this.user.roleBean.label}},created:function(){this.org=Number(this.$route.query.org),this.getOrg()},methods:{getOrg:function(){var e=this;i["a"].IOrganizationManager.getOrg({id:this.org}).then(function(a){e.ruleForm=a,e.urls={up:a.cdUpPhotoUrl||"",down:a.cdDownPhotoUrl||"",hand:a.cdHandPhotoUrl||"",license:a.licenseUrl||""},e.images={up:a.cdUpPhotoUrl||"",down:a.cdDownPhotoUrl||"",hand:a.cdHandPhotoUrl||"",license:a.licenseUrl||""}})},edit:function(e){var a=this;console.log(e,Object(s["a"])({},this.editing)),this.editing.value||(this.editing={value:!0,prop:e},r["default"].nextTick(function(){a.$refs[e].focus()}))},updateFullName:function(e){var a=this;Promise.resolve(!0).then(function(){a.$store.commit("UPDATE_USER",{fullName:e.target.value}),a.editing.value=!1}).catch(function(t){e.target.focus(),a.$message({type:"error",message:t.message||"企业全称修改失败"})})},updateContact:function(e){var a=this;Promise.resolve(!0).then(function(){a.$store.commit("UPDATE_USER",{mobilePhone:e.target.value}),a.editing.value=!1}).catch(function(t){e.target.focus(),a.$message({type:"error",message:t.message||"手机号修改失败"})})},updateMobilePhone:function(e){var a=this;Promise.resolve(!0).then(function(){a.$store.commit("UPDATE_USER",{mobilePhone:e.target.value}),a.editing.value=!1}).catch(function(t){e.target.focus(),a.$message({type:"error",message:t.message||"手机号修改失败"})})},handleBeforeUpload:function(e){var a="image/jpeg"===e.type,t="image/png"===e.type,l=e.size/1024/1024<3;return a||t||this.$message.error("上传图片只支持png，jpeg格式"),l||this.$message.error("上传图片大小不能超过 3MB"),(a||t)&&l},handleUploadSuccess:function(e){var a=this;return function(t,l){a.images[e]=URL.createObjectURL(l.raw),a.urls[e]=t}},handleUploadProgress:function(e){var a=this;return function(t,l){t.lengthComputable&&(a.progress[e]=t.percent)}},handleRemove:function(e,a){console.log("handleRemove",e,a)}}},c=u,d=(t("UMj/"),t("KHd+")),p=Object(d["a"])(c,l,o,!1,null,"6db5de1f",null);a["default"]=p.exports},"r/XA":function(e,a,t){}}]);