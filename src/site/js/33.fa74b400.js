(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[33],{FGjU:function(e,t,n){},RYdI:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{on:{click:function(t){e.menuparameter.show=!1}}},[n("Contextmenu",{attrs:{menuparameter:e.menuparameter},on:{selectedchanged:e.selectedchanged}}),n("div",[n("div",{staticClass:"common-top-nav-row"},[n("span",{staticClass:"form__label"},[e._v("代理商名称")]),n("el-select",{attrs:{filterable:"",placeholder:"请选择代理商"},on:{change:e.handleSelect},model:{value:e.iptValue,callback:function(t){e.iptValue=t},expression:"iptValue"}},[n("el-option",{attrs:{label:"全部代理商",value:""}}),e._l(e.proxylist,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})],2),e.access.add?n("el-button",{staticClass:"plus-button",attrs:{type:"info",size:"small"},on:{click:function(t){e.tochangeinfo("add")}}},[e._v("添加代理商")]):e._e()],1),n("div",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"span-method":e.colspan,border:"","max-height":e.clientHeight,"empty-text":"暂无相关代理信息"},on:{"header-contextmenu":e.headerclick}},["ALL"===e.showType?n("el-table-column",{attrs:{label:"",width:50},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.topped?n("div",{class:["el-table__expand-icon",e.expandKeys.indexOf(t.row.id)>-1?"el-table__expand-icon--expanded":""],on:{click:function(n){e.handleExpandChange(t.row.id)}}},[n("i",{staticClass:"el-icon el-icon-arrow-right"})]):e._e()]}}])}):e._e(),n("el-table-column",{attrs:{label:"代理名称",width:e.getmaxlength(function(e){return e.name},"代理名称")},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.name))])]}}])}),e.menuparameter.selected.indexOf("公司名称")>-1?n("el-table-column",{attrs:{width:e.getmaxlength(function(e){return e.company},"公司名称"),label:"公司名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.company))])]}}])}):e._e(),e.menuparameter.selected.indexOf("用户等级")>-1?n("el-table-column",{attrs:{width:(e.agentData.every(function(e){return""===e.level||null===e.level}),"80"),label:"用户等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(e.formatLevel(t.row)))])]}}])}):e._e(),e.menuparameter.selected.indexOf("所属账户")>-1?n("el-table-column",{attrs:{width:e.getmaxlength(function(e){return e.account},"所属账户"),label:"所属账户",prop:"account"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.account?t.row.account:"-"))])]}}])}):e._e(),e.menuparameter.selected.indexOf("联系人")>-1?n("el-table-column",{attrs:{width:e.getmaxlength(function(e){return e.contactor},"联系人"),label:"联系人",prop:"contactor"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.contactor))])]}}])}):e._e(),e.menuparameter.selected.indexOf("手机号")>-1?n("el-table-column",{attrs:{width:e.agentData.every(function(e){return""===e.mobilePhone||null===e.mobilePhone})?"78":"120",label:"手机号"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.mobilePhone))])]}}])}):e._e(),e.menuparameter.selected.indexOf("身份证号码")>-1?n("el-table-column",{attrs:{width:e.agentData.every(function(e){return""===e.idCard||null===e.idCard})?"110":"180",label:"身份证号码"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.idCard))])]}}])}):e._e(),e.menuparameter.selected.indexOf("电话号码")>-1?n("el-table-column",{attrs:{width:e.getmaxlength(function(e){return e.phone},"电话号码"),label:"电话号码"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.phone))])]}}])}):e._e(),e.menuparameter.selected.indexOf("电子邮箱")>-1?n("el-table-column",{attrs:{width:e.agentData.every(function(e){return""===e.email||null===e.email})?"80":"160",label:"电子邮箱"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.email))])]}}])}):e._e(),e.menuparameter.selected.indexOf("APPID")>-1?n("el-table-column",{attrs:{prop:"appid",label:"APPID",width:e.getmaxlength(function(e){return e.contactor},"appid")}}):e._e(),e.menuparameter.selected.indexOf("api密码")>-1?n("el-table-column",{attrs:{width:e.getmaxlength(function(e){return e.apiPwd},"api密码"),label:"api密码"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.apiPwd))])]}}])}):e._e(),e.menuparameter.selected.indexOf("登录账户")>-1?n("el-table-column",{attrs:{width:e.getmaxlength(function(e){return e.loginName},"登录账户"),label:"登录账户"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",[e._v(e._s(t.row.loginName))])]}}])}):e._e(),e.menuparameter.selected.indexOf("外部查询")>-1?n("el-table-column",{attrs:{label:"外部查询",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return["DISABLE"===t.row.externalQuery?n("div",[e._v("已关闭")]):e._e(),"ENABLE"===t.row.externalQuery?n("div",[e._v("已开启")]):e._e()]}}])}):e._e(),e.menuparameter.selected.indexOf("证件图片")>-1?n("el-table-column",{attrs:{label:"证件图片",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("span",{staticClass:"item__btn",on:{click:function(n){e.showIdCardImages(t.row)}}},[e._v("查看")])]}}])}):e._e(),e.menuparameter.selected.indexOf("操作")>-1?n("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.empty?n("span",{staticStyle:{display:"inline-block",width:"100%","text-align":"center"}},[e._v("暂无次级代理")]):n("div",[e.access.update?n("span",{staticClass:"item__btn",on:{click:function(n){e.tochangeinfo("edit",t.row)}}},[e._v("修改")]):e._e(),e._v(" \n              "),n("span",{staticClass:"item__btn",on:{click:function(n){e.tochangeinfo("detail",t.row)}}},[e._v("查看详情")])])]}}])}):e._e()],1),n("el-pagination",{attrs:{background:"","page-sizes":[10,20,30,40,50],"current-page":e.pager.pageIndex,layout:"total, sizes, prev, pager, next, jumper","page-size":e.pager.pageSize,total:e.pager.recCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),n("el-dialog",{attrs:{title:"证件照片",visible:e.idCardImgDialog.visible,width:"700px"},on:{close:e.closeImgDialog,"update:visible":function(t){e.$set(e.idCardImgDialog,"visible",t)}}},[n("div",{staticClass:"img__container--idcard"},[e.idCardImgDialog.up?n("img",{staticClass:"img__item",attrs:{src:e.idCardImgDialog.up,alt:""}}):n("div",{staticClass:"img__item img__placeholder"},[e._v("正面照未上传")]),e.idCardImgDialog.down?n("img",{staticClass:"img__item",attrs:{src:e.idCardImgDialog.down,alt:""}}):n("div",{staticClass:"img__item img__placeholder"},[e._v("反面照未上传")]),e.idCardImgDialog.hand?n("img",{staticClass:"img__item",attrs:{src:e.idCardImgDialog.hand,alt:""}}):n("div",{staticClass:"img__item img__placeholder"},[e._v("手持照未上传")])])])],1)},i=[],r=(n("yt8O"),n("pIFo"),n("rE2o"),n("ioFf"),n("rGqo"),n("iv4g")),l=n("oyJW"),o=n("yT7P"),s=n("Nlzp"),c=n("tjru"),d={name:"",data:function(){return{proxyId:"",iptValue:"",proxylist:[],clientHeight:0,pager:{pageIndex:1,pageSize:10,recCount:0},agentData:[],secProxy:{},menuparameter:{show:!1,position:{},list:["公司名称","用户等级","所属账户","联系人","手机号","身份证号码","电话号码","电子邮箱","APPID","api密码","登录账户","外部查询","证件图片","操作"],selected:["公司名称","用户等级","所属账户","联系人","手机号","身份证号码","电话号码","电子邮箱","APPID","api密码","登录账户","外部查询","证件图片","操作"]},expandKeys:[],idCardImgDialog:{visible:!1,up:"",down:"",hand:""},showType:"ALL",loading:!0}},computed:{access:function(){var e=this.$store.getters.access,t=e.ADD_PROXY,n=e.UPDATE_PROXY;return{add:t,update:n}},tableData:function(){var e=this.agentData,t=this.secProxy,n=this.expandKeys.reduce(function(e,t){return Object(o["a"])({},e,Object(l["a"])({},t,1))},{});return e.reduce(function(e,a){return Object(r["a"])(e).concat([a],Object(r["a"])(n[a.id]?t[a.id]:[]))},[])},colspan:function(){var e=this.agentData,t=this.secProxy,n=this.expandKeys.reduce(function(e,t){return Object(o["a"])({},e,Object(l["a"])({},t,1))},{}),a={},i=0,r=!0,s=!1,c=void 0;try{for(var d,u=e[Symbol.iterator]();!(r=(d=u.next()).done);r=!0){var p=d.value,h=n[p.id];i+=1,h&&(a[i]={start:1,len:t[p.id].length},t[p.id].slice(1).forEach(function(e,t){a[i+t+1]={follow:1}}),i+=t[p.id].length)}}catch(e){s=!0,c=e}finally{try{r||null==u.return||u.return()}finally{if(s)throw c}}return function(e){var t=e.row,n=(e.column,e.rowIndex),i=e.columnIndex,r=a[n];if(r){if(0===i){if(r.start)return{rowspan:r.len,colspan:1};if(r.follow)return{rowspan:0,colspan:0}}if(t.empty)return 1===i?{rowspan:1,colspan:13}:{rowspan:0,colspan:0}}}},user:function(){return this.$store.getters.user},internal:function(){return"ADMIN"===this.user.roleBean.label}},methods:{getmaxlength:function(e,t){var n=0;return this.tableData.forEach(function(t){var a=e(t),i=a?a.replace(/[^0-9a-zA-Z]/g,"--").length:0;n=i>n?i:n}),t&&n<t.replace(/[^0-9a-zA-Z]/g,"--").length&&(n=t.replace(/[^0-9a-zA-Z]/g,"--").length),8*n+21},getProxy:function(e){var t=this;this.resetExpandKeys(),s["a"].IProxyManager.getProxy({id:e}).then(function(e){t.agentData=[e],t.showType="ONE",t.pager={pageIndex:1,pageSize:10,recCount:1}}).catch(function(e){t.$message({type:"error",message:e.message||"代理商查询失败"})})},listProxies:function(e,t){var n=this;this.resetExpandKeys(),s["a"].IProxyManager.listProxies({page:e-1,size:t}).then(function(e){return Promise.all(e.content.map(function(e){return s["a"].IProxyManager.getSecProxylist({proxyId:e.id,deep:!0})})).then(function(t){n.agentData=e.content.map(function(e){return Object(o["a"])({},e,{topped:!0})}),n.showType="ALL",n.secProxy=e.content.reduce(function(e,n,a){return Object(o["a"])({},e,Object(l["a"])({},n.id,t[a].length?t[a].map(function(e){return Object(o["a"])({},e,{parentId:n.id})}):[{empty:!0,parentId:n.id}]))},{}),n.pager={pageIndex:e.number+1,pageSize:e.size,recCount:e.totalElements}})}).catch(function(e){n.$message({type:"error",message:e.message||"获取代理商列表失败"})}).then(function(){n.loading=!1})},selectedchanged:function(e){this.menuparameter.selected=e},headerclick:function(e,t){this.menuparameter.position.clientX=t.clientX,this.menuparameter.position.clientY=t.clientY,this.menuparameter.show=!0,t.preventDefault()},listBriefProxies:function(){var e=this;s["a"].IProxyManager.listBriefProxies({}).then(function(t){e.proxylist=t}).catch(function(t){e.$message({type:"error",message:t.message||"获取代理商选项失败"})})},handleCurrentChange:function(e){this.listProxies(e,this.pager.pageSize)},handleSizeChange:function(e){this.listProxies(1,e)},tochangeinfo:function(e,t){if("add"===e)this.$router.push({path:"/agentManage/agentOperation",query:{title:this.internal?"添加代理商":"添加次级代理商"}});else if("detail"===e)this.$router.push({path:"/agentManage/agentDetail",query:{title:"代理商详情",proxy:t.id}});else{if("edit"!==e)throw Error("unexpected type in tochangeinfo(type, row) {}");var n=t.topped;this.$router.push({path:"/agentManage/agentOperation",query:{title:n?"修改代理商":"修改次级代理商",proxy:t.id}})}},showIdCardImages:function(e){this.idCardImgDialog={visible:!0,up:e.cdUpPhotoUrl,down:e.cdDownPhotoUrl,hand:e.cdHandPhotoUrl}},closeImgDialog:function(){this.idCardImgDialog={visible:!1,up:"",down:"",hand:""}},handleSelect:function(e){e?this.getProxy(e):this.listProxies(1,this.pager.pageSize)},handleExpandChange:function(e){var t=this.expandKeys.indexOf(e)>-1;this.expandKeys=t?this.expandKeys.filter(function(t){return t!==e}):this.expandKeys.concat(e)},resetExpandKeys:function(){this.internal?this.expandKeys=[]:this.expandKeys=[this.user.id]},setup:function(){this.iptValue="",this.listProxies(1,10),this.listBriefProxies()},formatLevel:function(e){var t=this.internal;return t?Object(c["a"])(e.level)+"级代理":e.id===this.user.id?"代理商":"次级代理"}},created:function(){this.clientHeight=document.body.clientHeight>662?550:400,this.setup()}},u=d,p=(n("YaQh"),n("KHd+")),h=Object(p["a"])(u,a,i,!1,null,"33c929fb",null);t["default"]=h.exports},YaQh:function(e,t,n){"use strict";var a=n("FGjU"),i=n.n(a);i.a},tjru:function(e,t,n){"use strict";n("pIFo");var a=function e(t){var n={0:"零",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"七",8:"八",9:"九",10:"十"};if(t<10)return n[t];var a=[Math.floor(t/1e4),t%1e4],i=a[0],r=a[1],l=[Math.floor(r/1e3),r%1e3],o=l[0],s=l[1],c=[Math.floor(s/100),s%100],d=c[0],u=c[1],p=[Math.floor(u/10),u%10],h=p[0],g=p[1],m=(i>1e4?e(Math.floor(i/1e4))+"亿"+(i%1e4>1e3?"":"零")+e(i%1e4)+"万":e(i)+"万")+n[o]+"千"+n[d]+"百"+n[h]+"十"+n[g];return m.replace(/零万|零千|零百|零十/g,"零").replace(/^零+/,"").replace(/零+$/,"").replace(/零+/g,"零").replace("万万","亿").replace(/^一十/,"十")};t["a"]=a}}]);