(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{NIQY:function(e,t,r){"use strict";var a=r("b7fh"),o=r.n(a);o.a},b7fh:function(e,t,r){},gLI6:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-dialog",{attrs:{title:"开通渠道商账户",visible:e.dialogVisible,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[r("el-form-item",{attrs:{label:"关联渠道商ID：","label-width":"120px",prop:"distributorId"}},[r("el-input",{staticStyle:{width:"70%"},attrs:{"auto-complete":"off",placeholder:"请输入企业ID"},model:{value:e.form.distributorId,callback:function(t){e.$set(e.form,"distributorId",t)},expression:"form.distributorId"}})],1),r("el-form-item",{attrs:{label:"企业简称：","label-width":"120px"}},[r("el-input",{staticStyle:{width:"70%"},attrs:{"auto-complete":"off",placeholder:"企业简称",disabled:!0},model:{value:e.form.shortName,callback:function(t){e.$set(e.form,"shortName",t)},expression:"form.shortName"}})],1),r("el-form-item",{attrs:{label:"企业关联销售：","label-width":"120px"}},[r("el-input",{staticStyle:{width:"70%"},attrs:{"auto-complete":"off",placeholder:"企业关联销售",disabled:!0},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("form")}}},[e._v("开 通")])],1)],1),e.opened?r("div",[r("div",{staticClass:"top"},[r("div",{staticClass:"value-container"},[r("div",{staticClass:"icon-style icon-moneybag"}),r("div",{staticClass:"text"},[e._v("安全保障金")]),r("div",{staticClass:"value-num"},[e._v("¥"+e._s(e.OrganizationBean.frozenAmount))]),1===e.status?r("el-button",{staticClass:"refresh-button",attrs:{type:"text"},on:{click:e.refreshFrozenAmount}},[e._v("刷新")]):e._e(),0===e.status?r("div",{staticClass:"conculating"},[e._v("计算中...")]):e._e()],1),r("div",{staticClass:"value-container"},[r("div",{staticClass:"icon-style icon-sheild"}),r("div",{staticClass:"text"},[e._v("账户余额")]),r("div",{staticClass:"value-num2"},[e._v("¥"+e._s(e.OrganizationBean.balance))])]),r("div",{staticClass:"right-bottom-container"},[r("el-button",{staticClass:"charge",on:{click:function(t){e.turnrouter("充值")}}},[e._v("充值")]),r("el-button",{staticClass:"tomoney",on:{click:function(t){e.turnrouter("提现")}}},[e._v("提现")])],1)]),r("div",{staticClass:"middle-line"}),r("div",{staticClass:"bottom"},[r("div",{staticClass:"title"},[e._v("财务帐单")]),r("div",{staticClass:"search-row"},[r("span",{staticClass:"search-type"},[e._v("交易类型")]),r("el-select",{attrs:{placeholder:"请选择交易类型"},model:{value:e.orderCategory,callback:function(t){e.orderCategory=t},expression:"orderCategory"}},[r("el-option",{attrs:{label:"全部类型",value:""}}),e._l(e.orderCategoryoptions,function(e){return r("el-option",{key:e.type,attrs:{label:e.name,value:e.type}})})],2),r("span",{staticClass:"search-type"},[e._v("订单创建时间")]),r("el-date-picker",{attrs:{clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.createTimeStart,callback:function(t){e.createTimeStart=t},expression:"createTimeStart"}}),r("span",{staticStyle:{margin:"0 10px","font-size":"14px"}},[e._v("到")]),r("el-date-picker",{attrs:{clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.createTimeEnd,callback:function(t){e.createTimeEnd=t},expression:"createTimeEnd"}}),r("el-button",{staticStyle:{"margin-left":"10px",width:"100px"},attrs:{type:"primary"},on:{click:e.listOrdersByConditions}},[e._v("搜索")]),r("span",{staticClass:"racleicon reverse",on:{click:function(t){e.listOrdersByConditions("referesh")}}}),r("span",{staticClass:"racleicon donwload"})],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.orderFormBeans,"max-height":e.clientHeight,border:""}},[r("el-table-column",{attrs:{label:"订单编号","min-width":e.orderFormBeans.every(function(e){return""===e.orderId||null===e.orderId})?"90":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"#038ae3",cursor:"pointer"}},[e._v("\n                "+e._s(""===t.row.orderId||null===t.row.orderId?"-":t.row.orderId)+"\n              ")])]}}])}),r("el-table-column",{attrs:{label:"交易类型","min-width":e.orderFormBeans.every(function(e){return""===e.orderCategory||null===e.orderCategory})?"90":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(""===t.row.orderCategory||null===t.row.orderCategory?"-":t.row.orderCategory)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"金额","min-width":e.orderFormBeans.every(function(e){return""===e.amount||null===e.amount})?"90":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(""===t.row.amount||null===t.row.amount?"-":"¥"+t.row.amount)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"订单状态","min-width":e.orderFormBeans.every(function(e){return""===e.orderStatus||null===e.orderStatus})?"90":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(""===t.row.orderStatus||null===t.row.orderStatus?"-":t.row.orderStatus)+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"订单创建时间","min-width":e.orderFormBeans.every(function(e){return""===e.createTime||null===e.createTime})?"130":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("time")(""===t.row.createTime||null===t.row.createTime?"-":t.row.createTime,"yyyy-MM-dd HH:mm:ss"))+"\n            ")]}}])}),r("el-table-column",{attrs:{label:"订单处理时间","min-width":e.orderFormBeans.every(function(e){return""===e.completeTime||null===e.completeTime})?"130":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("time")(""===t.row.completeTime||null===t.row.completeTime?"-":t.row.completeTime,"yyyy-MM-dd HH:mm:ss"))+"\n            ")]}}])})],1),r("el-pagination",{attrs:{background:"","page-sizes":[10,20,30,40,50],"current-page":e.pager.pageIndex,layout:"sizes, prev, pager, next","page-size":e.pager.pageSize,total:e.pager.recCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]):e._e(),e.opened?e._e():r("div",{staticClass:"no-proxy"},[r("div",{staticClass:"remind-text"}),r("el-button",{staticClass:"openbutton",on:{click:function(t){e.dialogVisible=!e.dialogVisible}}},[e._v("开通渠道商账")])],1)],1)},o=[],n=(r("VRzm"),r("19FS")),i=r("Nlzp"),s={data:function(){return{status:1,form:{},rules:{distributorId:[{required:!0,message:"请输入企业id",trigger:"blur"}]},orderFormBeans:[],orderCategoryoptions:[{type:"PURCHASE",name:"采购"},{type:"HANDLE",name:"订购"},{type:"SETTLE",name:"结算"},{type:"CHANGE",name:"变更"},{type:"WITHDRAW",name:"提现"},{type:"DEPOSIT",name:"充值"}],clientHeight:0,dialogVisible:!1,loading:!0,createTimeStart:"",createTimeEnd:"",OrganizationBean:{balance:"",frozenAmount:""},opened:!1,orderCategory:"",pager:{pageIndex:1,pageSize:10,recCount:0}}},created:function(){this.clientHeight=document.body.clientHeight>=794?550:160,this.getOrg()},computed:{user:function(){return this.$store.getters.user}},watch:{dialogVisible:function(e){this.$refs["form"].resetFields()}},methods:{refreshFrozenAmount:function(){var e=this;i["a"].IAccountManager.refreshFrozenAmount({orgId:this.user.orgId}).then(function(t){e.status=t}).catch(function(t){e.$message({type:"error",message:t.message||"更改保障金刷新状态失败"})})},listOrdersByConditions:function(e){var t=this;i["a"].IAccountManager.listOrdersByConditions({distributorId:this.user.orgId,orderCategory:this.orderCategory,createTimeStart:this.createTimeStart,createTimeEnd:this.createTimeEnd,index:this.pager.index-1,pageSize:this.pager.pageSize}).then(function(r){t.loading=!1,t.orderFormBeans=r,t.pager.pageIndex=r.index,t.pager.recCount=r.totalElements,"refresh"===e&&t.$message({type:"success",message:"数据刷新"})}).catch(function(e){t.$message({type:"error",message:e.message||"获取渠道商财务账单失败"})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;t.addAssociateSuperiorDistributor()})},addAssociateSuperiorDistributor:function(){var e=this;i["a"].IAccountManager.addAssociateSuperiorDistributor({brokerId:this.user.orgId,distributorId:this.form.distributorId,userId:this.user.id}).then(function(t){e.$message({type:"success",message:"开通成功"}),e.dialogVisible=!e.dialogVisible,window.location.reload()}).catch(function(t){e.$message({type:"error",message:t.message||"开通失败"})})},getOrg:function(){var e=this;i["a"].IAccountManager.getOrg({id:this.user.orgId}).then(function(t){e.opened="DISTRIBUTOR"===t.orgCategory,"DISTRIBUTOR"===t.orgCategory&&(e.form.shortName=t.shortName,e.OrganizationBean.balance=t.distributorBalance||t.brokerBalance,e.OrganizationBean.frozenAmount=t.frozenAmount,e.getRefreshFrozenAmountStatus(),e.listOrdersByConditions())}).catch(function(t){e.$message({type:"error",message:t.message||"初始化创建开通失败"})})},getRefreshFrozenAmountStatus:function(){var e=this;i["a"].IAccountManager.getRefreshFrozenAmountStatus({orgId:this.user.orgId}).then(function(t){e.status=t}).catch(function(t){e.$message({type:"error",message:t.message||"获取保障金刷新状态失败"})})},getAvailableAssociateSales:function(){var e=this;i["a"].IAccountManager.getAvailableAssociateSales({distributorId:this.form.distributorId,brokerId:this.user.orgId}).then(function(t){e.form.shortName=t.shortName}).catch(function(t){e.$message({type:"error",message:t.message||"初始化创建开通失败"})})},turnrouter:function(e){this.$router.push({path:"充值"===e?"distributor/charge":"distributor/withdraw",query:{title:e,orgCategory:"DISTRIBUTOR"}})},handleCurrentChange:function(e){this.pager.pageIndex=e,this.listByCondition()},handleSizeChange:function(e){this.pager.pageSize=e,this.listByCondition()}},filters:{time:function(e,t){return e?n["format"](e,t):"-"}}},l=s,c=(r("NIQY"),r("KHd+")),u=Object(c["a"])(l,a,o,!1,null,"1f77285f",null);t["default"]=u.exports}}]);