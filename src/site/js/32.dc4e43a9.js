(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[32],{am91:function(e,a,t){},omJE:function(e,a,t){"use strict";t.r(a);var l=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"conteiner--proxy-form"},[t("BackButton"),t("el-form",{ref:"formLabelAlign",staticClass:"iot__form form-pos",attrs:{"label-width":"120px","inline-message":!0,model:e.formLabelAlign,rules:e.rules,"label-position":"left"}},[t("div",{staticClass:"info-item"},[t("div",{staticClass:"inner-filt"},[e._v("企业信息")])]),t("el-form-item",{attrs:{label:"代理名称:",prop:"name"}},[t("el-input",{model:{value:e.formLabelAlign.name,callback:function(a){e.$set(e.formLabelAlign,"name",a)},expression:"formLabelAlign.name"}})],1),t("el-form-item",{attrs:{label:"公司名称:",prop:"company"}},[t("el-input",{model:{value:e.formLabelAlign.company,callback:function(a){e.$set(e.formLabelAlign,"company",a)},expression:"formLabelAlign.company"}})],1),t("div",{staticClass:"info-item"},[t("div",{staticClass:"inner-filt"},[e._v("管理者信息")])]),t("el-form-item",{attrs:{label:"联系人:",prop:"contactor"}},[t("el-input",{model:{value:e.formLabelAlign.contactor,callback:function(a){e.$set(e.formLabelAlign,"contactor",a)},expression:"formLabelAlign.contactor"}})],1),t("el-form-item",{attrs:{label:"手机号码:",prop:"mobilePhone"}},[t("el-input",{model:{value:e.formLabelAlign.mobilePhone,callback:function(a){e.$set(e.formLabelAlign,"mobilePhone",a)},expression:"formLabelAlign.mobilePhone"}})],1),t("el-form-item",{attrs:{label:"身份证号码:",prop:"idCard"}},[t("el-input",{model:{value:e.formLabelAlign.idCard,callback:function(a){e.$set(e.formLabelAlign,"idCard",a)},expression:"formLabelAlign.idCard"}})],1),t("el-form-item",{attrs:{label:"电话号码:",prop:"phone"}},[t("el-input",{model:{value:e.formLabelAlign.phone,callback:function(a){e.$set(e.formLabelAlign,"phone",a)},expression:"formLabelAlign.phone"}})],1),t("el-form-item",{attrs:{label:"电子邮箱:",prop:"email"}},[t("el-input",{model:{value:e.formLabelAlign.email,callback:function(a){e.$set(e.formLabelAlign,"email",a)},expression:"formLabelAlign.email"}})],1),t("el-form-item",{staticStyle:{"min-width":"800px"},attrs:{label:"证件图片:"}},[t("el-upload",{staticClass:"upload__container upload--up",attrs:{name:"file","show-file-list":!1,action:"/portal-srv/upload/idcard","before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("up"),"on-progress":e.handleUploadProgress("up"),"on-remove":e.handleRemove}},[e.images.up?t("img",{staticClass:"avatar",attrs:{src:e.images.up}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("el-upload",{staticClass:"upload__container upload--down",attrs:{action:"/portal-srv/upload/idcard",name:"file","show-file-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("down"),"on-progress":e.handleUploadProgress("down"),"on-remove":e.handleRemove}},[e.images.down?t("img",{staticClass:"avatar",attrs:{src:e.images.down}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("el-upload",{staticClass:"upload__container upload--hand",attrs:{action:"/portal-srv/upload/idcard",name:"file","show-file-list":!1,"before-upload":e.handleBeforeUpload,"on-success":e.handleUploadSuccess("hand"),"on-progress":e.handleUploadProgress("hand"),"on-remove":e.handleRemove}},[e.images.hand?t("img",{staticClass:"avatar",attrs:{src:e.images.hand}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("div",{staticClass:"info-item"},[t("div",{staticClass:"inner-filt"},[e._v("账户信息")])]),t("el-form-item",{attrs:{label:"登录账户:",prop:"loginName"}},[t("el-input",{attrs:{disabled:"edit"===e.handletype},model:{value:e.formLabelAlign.loginName,callback:function(a){e.$set(e.formLabelAlign,"loginName",a)},expression:"formLabelAlign.loginName"}})],1),t("el-form-item",{attrs:{label:"初始密码:"}},[t("el-input",{staticStyle:{width:"38%"},attrs:{value:e.formLabelAlign.loginName+"123",disabled:!0}}),"edit"===e.handletype&&"ADMIN"===this.user.roleBean.label?t("el-button",{staticStyle:{"vertical-align":"top","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.resetPassword}},[e._v("\n        重置为初始密码\n      ")]):e._e()],1),e._e(),t("el-form-item",["add"===e.handletype?t("el-button",{staticClass:"confirm-button",staticStyle:{"margin-right":"18px"},attrs:{plain:"",loading:e.submitting},on:{click:e.save}},[e._v("添加")]):t("el-button",{staticClass:"confirm-button",staticStyle:{"margin-right":"18px"},attrs:{plain:"",loading:e.submitting},on:{click:e.save}},[e._v(e._s("add"===e.handletype?"添加":"保存"))]),t("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)],1)],1)},r=[],o=t("yT7P"),n=(t("SRfc"),t("Nlzp")),i=function(e){return!!e.match(/^\d{15}$/)||!!e.match(/^\d{17}(\d{1}|X)$/i)},s=function(e){return!!e.match(/^((0\d{2,3})-)(\d{7,8})(-(\d{3,}))?$/)},m=function(e,a,t){return a=a.trim(),a.length?t(i(a)?void 0:Error("请输入正确的身份证号")):t(Error("请输入身份证号"))},d=function(e,a,t){return a=a.trim(),a.length?t(s(a)?void 0:Error("请输入正确的电话号码")):t()},c={name:"",data:function(){return{handletype:"",formLabelAlign:{},rules:{name:[{required:!0,message:"请输入1-50个字符",trigger:"blur"},{min:1,max:50,message:"请输入1-50个字符",trigger:"blur"}],company:[{required:!0,message:"请输入1-128个字符",trigger:"blur"},{min:1,max:128,message:"请输入1-128个字符",trigger:"blur"}],contactor:[{required:!0,message:"请输入1-20个字符",trigger:"blur"},{min:1,max:20,message:"请输入1-20个字符",trigger:"blur"}],mobilePhone:[{required:!0,pattern:/^\d{11}$/g,message:"请输入手机号码",trigger:"blur"}],idCard:[{required:!0,validator:m,trigger:"blur"}],phone:[{validator:d,trigger:"blur"}],email:[{required:!1,type:"email",message:"请输入邮箱",trigger:"blur"}],loginName:[{required:!0,message:"请输入1-20个字符",trigger:"blur"},{min:1,max:20,message:"请输入1-20个字符",trigger:"blur"}],originPswd:[{required:!1}],roleName:[{required:!1}]},user:{},roles:[],images:{up:"",down:"",hand:""},urls:{up:"",down:"",hand:""},progress:{up:0,down:0,hand:0},submitting:!1}},methods:{resetPassword:function(){var e=this;n["a"].IUserService.resetPassword({loginName:this.formLabelAlign.loginName}).then(function(){e.$message({type:"success",message:"密码重置成功"})}).catch(function(a){e.$message({type:"error",message:a.message||"密码重置失败"})})},save:function(){this.submitForm("formLabelAlign")},cancel:function(){this.$router.push({path:"/agentManage"})},submitForm:function(e){var a=this;this.submitting||this.$refs[e].validate(function(e){e&&(a.submitting=!0,"add"===a.handletype?n["a"].IProxyManager.add({proxy:Object(o["a"])({},a.formLabelAlign,{cdUpPhotoUrl:a.urls.up,cdDownPhotoUrl:a.urls.down,cdHandPhotoUrl:a.urls.hand})}).then(function(e){a.submitting=!1,a.$message({type:"success",message:"添加成功"}),setTimeout(function(){return a.$router.push({path:"/agentManage"})},2e3)}).catch(function(e){a.submitting=!1,a.$message({type:"error",message:e.message||"添加失败"})}):"edit"===a.handletype&&n["a"].IProxyManager.update({proxy:Object(o["a"])({},a.formLabelAlign,{cdUpPhotoUrl:a.urls.up,cdDownPhotoUrl:a.urls.down,cdHandPhotoUrl:a.urls.hand})}).then(function(e){a.submitting=!1,a.$message({type:"success",message:"修改成功"}),setTimeout(function(){return a.$router.push({path:"/agentManage"})},2e3)}).catch(function(e){a.submitting=!1,a.$message({type:"error",message:e.message||"修改失败"})}))})},handleUploadSuccess:function(e){var a=this;return function(t,l){a.images[e]=URL.createObjectURL(l.raw),a.urls[e]=t}},handleUploadProgress:function(e){var a=this;return function(t,l){t.lengthComputable&&(a.progress[e]=t.percent)}},handleBeforeUpload:function(e){var a="image/jpeg"===e.type,t="image/png"===e.type,l=e.size/1024/1024<3;return a||t||this.$message.error("上传图片只支持png，jpeg格式"),l||this.$message.error("上传图片大小不能超过 3MB"),(a||t)&&l},handleRemove:function(e,a){console.log("handleRemove",e,a)}},created:function(){var e=this;this.user=this.$store.getters.user;var a=this.$route.query.proxy;a?(this.handletype="edit",n["a"].IProxyManager.getProxy({id:+a}).then(function(a){e.formLabelAlign=a,e.urls={up:a.cdUpPhotoUrl||"",down:a.cdDownPhotoUrl||"",hand:a.cdHandPhotoUrl||""},e.images={up:a.cdUpPhotoUrl||"",down:a.cdDownPhotoUrl||"",hand:a.cdHandPhotoUrl||""}})):(this.handletype="add",this.formLabelAlign={name:"",company:"",contactor:"",mobilePhone:"",idCard:"",phone:"",email:"",cdDownPhotoUrl:"",cdUpPhotoUrl:"",cdHandPhotoUrl:"",loginName:"",roleId:""})}},u=c,p=(t("w8ld"),t("KHd+")),g=Object(p["a"])(u,l,r,!1,null,"785a5d50",null);a["default"]=g.exports},w8ld:function(e,a,t){"use strict";var l=t("am91"),r=t.n(l);r.a}}]);